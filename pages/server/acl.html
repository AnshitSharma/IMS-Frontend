<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Access Control List - BDC Inventory Management System</title>
    <link rel="stylesheet" href="../../assets/css/tailwind.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="bg-slate-50">
    <!-- Navigation Header -->
     <div id="navbar-placeholder"></div>

    <!-- Main Content -->
    <div class="main-container flex">
        <!-- Sidebar -->
        <aside class="sidebar w-64 bg-white border-r border-slate-200 min-h-screen">
            <div class="sidebar-header px-4 py-4 border-b border-slate-200">
                <h3 class="font-semibold text-slate-800">System Management</h3>
            </div>

            <ul class="sidebar-menu">
                <li class="menu-item px-4 py-3 flex items-center gap-3 cursor-pointer hover:bg-slate-50" data-component="dashboard" onclick="window.location.href='../../pages/dashboard/index.html'">
                    <i class="fas fa-tachometer-alt text-slate-600"></i>
                    <span class="text-sm text-slate-700">Dashboard</span>
                </li>
                <li class="menu-item px-4 py-3 flex items-center gap-3 cursor-pointer hover:bg-slate-50" data-component="servers" onclick="window.location.href='configuration.html'">
                    <i class="fas fa-server text-slate-600"></i>
                    <span class="text-sm text-slate-700">Server Configurations</span>
                </li>
                <li class="menu-item active px-4 py-3 flex items-center gap-3 cursor-pointer bg-primary-50 border-l-4 border-primary" data-component="acl">
                    <i class="fas fa-shield-alt text-primary"></i>
                    <span class="text-sm font-medium text-primary">Access Control</span>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content flex-1 p-6">
            <div class="acl-container">
                <!-- ACL Header -->
                <div class="acl-header bg-white rounded-lg shadow-sm p-6 mb-6">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div class="acl-title flex items-center gap-2 text-2xl font-bold text-slate-800">
                            <i class="fas fa-shield-alt text-primary"></i>
                            Access Control List (ACL)
                        </div>
                        <div class="acl-controls flex flex-wrap items-center gap-3">
                            <button class="btn btn-success px-4 py-2 bg-success text-white rounded-lg hover:bg-success-600 transition-colors flex items-center gap-2" id="createRoleBtn">
                                <i class="fas fa-plus"></i> Create Role
                            </button>
                            <button class="btn btn-danger px-4 py-2 bg-danger text-white rounded-lg hover:bg-danger-600 transition-colors flex items-center gap-2" id="deleteRoleBtn">
                                <i class="fas fa-trash"></i> Delete Role
                            </button>
                            <div class="role-selector flex items-center gap-2">
                                <label for="roleSelect" class="text-sm font-medium text-slate-700">Select Role:</label>
                                <select id="roleSelect" class="px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <option value="">Choose a role...</option>
                                    <option value="admin">Admin</option>
                                    <option value="superadmin">SuperAdmin</option>
                                    <option value="manager">Manager</option>
                                    <option value="viewer">Viewer</option>
                                </select>
                            </div>
                            <button class="btn btn-primary px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors flex items-center gap-2" id="loadPermissionsBtn">
                                <i class="fas fa-sync-alt"></i> Load Permissions
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Permissions Summary -->
                <div class="permissions-summary bg-white rounded-lg shadow-sm p-4 mb-6 flex flex-wrap items-center justify-between gap-4">
                    <div class="permissions-count text-sm text-slate-700">
                        All Permissions (Total: <span class="total font-semibold text-primary" id="totalPermissions">77</span>)
                    </div>
                    <div class="permission-controls flex gap-3">
                        <button class="btn btn-link text-primary hover:underline text-sm" id="selectAllBtn">Select All</button>
                        <button class="btn btn-link text-primary hover:underline text-sm" id="unselectAllBtn">Unselect All</button>
                    </div>
                    <div class="permissions-count text-sm text-slate-700">
                        Selected: <span class="total font-semibold text-success" id="selectedPermissions">0</span>
                    </div>
                </div>

                <!-- Permissions Grid -->
                <div id="permissionsContainer" class="bg-white rounded-lg shadow-sm p-6">
                    <div class="loading-state text-center py-16">
                        <i class="fas fa-spinner text-4xl text-slate-400 mb-4"></i>
                        <p class="text-slate-600">Select a role and click "Load Permissions" to view access controls</p>
                    </div>
                </div>

                <!-- ACL Actions -->
                <div class="acl-actions flex items-center justify-end gap-3 mt-6" id="aclActions">
                    <button class="btn btn-success px-6 py-2 bg-success text-white rounded-lg hover:bg-success-600 transition-colors flex items-center gap-2" id="savePermissionsBtn">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                    <button class="btn btn-secondary px-6 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors flex items-center gap-2" id="resetPermissionsBtn">
                        <i class="fas fa-undo"></i> Reset
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Create Role Modal -->
    <div id="createRoleModal" class="modal fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="modal-content bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden">
            <div class="modal-header flex items-center justify-between px-6 py-4 border-b border-slate-200">
                <h2 class="text-xl font-semibold text-slate-800 flex items-center gap-2">
                    <i class="fas fa-user-shield text-primary"></i> Create New Role
                </h2>
                <button class="modal-close text-slate-400 hover:text-slate-600 text-2xl leading-none" id="closeModalBtn">&times;</button>
            </div>
            <div class="modal-body overflow-y-auto px-6 py-4 max-h-[60vh]">
                <!-- Role Information Section -->
                <div class="role-info-section mb-6">
                    <h3 class="section-title text-lg font-semibold text-slate-800 mb-4">Role Information</h3>
                    <div class="space-y-4">
                        <div class="form-group">
                            <label for="roleName" class="block text-sm font-medium text-slate-700 mb-2">
                                Role Name <span class="required text-red-500">*</span>
                            </label>
                            <input type="text" id="roleName" class="form-input w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Enter role name" required>
                        </div>
                        <div class="form-group">
                            <label for="roleType" class="block text-sm font-medium text-slate-700 mb-2">
                                Role Type <span class="required text-red-500">*</span>
                            </label>
                            <input type="text" id="roleType" class="form-input w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Enter custom role type" required>
                        </div>
                        <div class="form-group">
                            <label for="roleDescription" class="block text-sm font-medium text-slate-700 mb-2">Role Description</label>
                            <textarea id="roleDescription" class="form-textarea w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent resize-y" placeholder="Enter role description (optional)" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="roleLevel" class="block text-sm font-medium text-slate-700 mb-2">Role Level / Priority</label>
                            <input type="number" id="roleLevel" class="form-input w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Enter role level (optional)" min="1" max="100">
                        </div>
                    </div>
                </div>

                <!-- Permission Selection Section -->
                <div class="permission-selection-section hidden" id="permissionSelectionSection">
                    <h3 class="section-title text-lg font-semibold text-slate-800 mb-4">Permission Selection</h3>
                    <div id="modalPermissionsContainer" class="modal-permissions-grid space-y-4">
                        <!-- Permissions will be dynamically loaded here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer flex items-center justify-end gap-3 px-6 py-4 border-t border-slate-200">
                <button class="btn btn-secondary px-6 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors flex items-center gap-2" id="cancelModalBtn">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-success px-6 py-2 bg-success text-white rounded-lg hover:bg-success-600 transition-colors flex items-center gap-2" id="saveRoleBtn">
                    <i class="fas fa-save"></i> Save Role
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Role Modal -->
    <div id="deleteRoleModal" class="modal fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="modal-content delete-modal bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4">
            <div class="modal-header flex items-center justify-between px-6 py-4 border-b border-slate-200">
                <h2 class="text-xl font-semibold text-slate-800 flex items-center gap-2">
                    <i class="fas fa-trash-alt text-danger"></i> Delete Role
                </h2>
                <button class="modal-close text-slate-400 hover:text-slate-600 text-2xl leading-none" id="closeDeleteModalBtn">&times;</button>
            </div>
            <div class="modal-body px-6 py-4">
                <p class="delete-warning flex items-center gap-2 text-warning-700 bg-warning-50 border border-warning-200 rounded-lg p-4 mb-4">
                    <i class="fas fa-exclamation-triangle"></i> Select a role to delete. Default system roles cannot be deleted.
                </p>
                <div id="deleteRoleList" class="delete-role-list space-y-2">
                    <!-- Role list will be dynamically loaded here -->
                </div>
            </div>
            <div class="modal-footer flex items-center justify-end gap-3 px-6 py-4 border-t border-slate-200">
                <button class="btn btn-secondary px-6 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors flex items-center gap-2" id="cancelDeleteBtn">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="modal-content confirm-modal bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="modal-header flex items-center justify-between px-6 py-4 border-b border-slate-200">
                <h2 class="text-xl font-semibold text-slate-800 flex items-center gap-2">
                    <i class="fas fa-exclamation-circle text-warning"></i> Confirm Deletion
                </h2>
                <button class="modal-close text-slate-400 hover:text-slate-600 text-2xl leading-none" id="closeConfirmModalBtn">&times;</button>
            </div>
            <div class="modal-body px-6 py-4">
                <p id="confirmMessage" class="text-slate-700">Are you sure you want to delete this role?</p>
            </div>
            <div class="modal-footer flex items-center justify-end gap-3 px-6 py-4 border-t border-slate-200">
                <button class="btn btn-secondary px-6 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors flex items-center gap-2" id="cancelConfirmBtn">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-danger px-6 py-2 bg-danger text-white rounded-lg hover:bg-danger-600 transition-colors flex items-center gap-2" id="confirmDeleteBtn">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../../assets/js/toast.js"></script>
    <script src="../../assets/js/server/acl.js"></script>
    <script src="../../components/navbar.js"></script>
</body>
</html>
